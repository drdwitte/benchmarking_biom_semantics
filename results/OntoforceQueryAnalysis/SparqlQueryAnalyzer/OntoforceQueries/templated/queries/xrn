PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX  dc: <http://purl.org/dc/elements/1.1/> PREFIX  rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX  rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX  dcterms: <http://purl.org/dc/terms/> SELECT (?class AS ?val) (COUNT(DISTINCT ?original) AS ?vc) WHERE { ?original a ?class . { SELECT ?original ?assoc WHERE { ?original <http://ns.ontoforce.com/2013/disqover#preferredUri> ?assoc. { SELECT ?class ?original_1 ?p WHERE { FILTER(?original_1_linked IN ()) ?original_1_linked <http://ns.ontoforce.com/2013/disqover#preferredUri> ?pref. ?s <http://ns.ontoforce.com/2013/disqover#preferredUri> ?pref { ?s ?p ?original_1 } UNION { ?original_1 ?p ?s } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original_1 a ?class. } } UNION { SELECT ?class ?original_1 ?p WHERE { FILTER(?original_1_linked IN ()) { ?original_1_linked ?p ?original_1 } UNION { ?original_1 ?p ?original_1_linked } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original_1 a ?class. } } UNION { SELECT ?class ?original_1 ?p WHERE { FILTER(?original_1_linked IN ()) { ?original_1_linked ?p ?original_1_nopref } UNION { ?original_1_nopref ?p ?original_1_linked } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original_1_nopref a ?class. ?original_1_nopref <http://ns.ontoforce.com/2013/disqover#preferredUri> ?original_1. FILTER( ?original_1_nopref != ?original_1) } } ?original_1 <http://ns.ontoforce.com/2013/disqover#preferredUri> ?assoc. FILTER(!BOUND(?facet_value_3)) } } UNION { SELECT ?original ?assoc WHERE { { SELECT ?class ?original ?p WHERE { FILTER(?original_linked IN ()) ?original_linked <http://ns.ontoforce.com/2013/disqover#preferredUri> ?pref. ?s <http://ns.ontoforce.com/2013/disqover#preferredUri> ?pref { ?s ?p ?original } UNION { ?original ?p ?s } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original a ?class. } } UNION { SELECT ?class ?original ?p WHERE { FILTER(?original_linked IN ()) { ?original_linked ?p ?original } UNION { ?original ?p ?original_linked } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original a ?class. } } UNION { SELECT ?class ?original ?p WHERE { FILTER(?original_linked IN ()) { ?original_linked ?p ?original_nopref } UNION { ?original_nopref ?p ?original_linked } FILTER(!(?p IN (<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>, <http://ns.ontoforce.com/2013/disqover#preferredUri>))). ?original_nopref a ?class. ?original_nopref <http://ns.ontoforce.com/2013/disqover#preferredUri> ?original. FILTER( ?original_nopref != ?original) } } OPTIONAL { ?original <http://ns.ontoforce.com/2013/disqover#preferredUri> ?assoc. } FILTER(!BOUND(?assoc)) FILTER(!BOUND(?facet_value_3)) } } } GROUP BY ?class 
